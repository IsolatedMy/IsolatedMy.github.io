---
title: 量子线路作图工具qpic
comments: true
mathjax: true
layout: articles
toc: true
tags: ["quantum computing", "translation"]
---

这篇文章主要介绍了量子线路的画图工具qpic，文章的内容翻译自github上的[qpic项目提供的文档](https://github.com/qpic/qpic/blob/master/doc/qpic_doc.pdf)。

<!--more-->

## 一、介绍

<div align=center><img src="{{ site.baseurl }}/assets/images/2021/qpic-1.png" style="zoom:30%" id="qpic-1"></div>

[Figure-1](#qpic-1)中展示了一个翻转$n$线上保存的信息且深度为$2n + 2$的线路，其中允许的操作是将一条线加到另一条相邻的线上。证明线路是正确的需要超过600词，但是主要思想通过图中红色标注的子线路传递。

这张图表示利用`<q|pic>`创建的。`<q|pic>`使用户可以以一种简单、人类可读的语言描述线路，一行可以声明一条线(wire)或声明一个逻辑操作，又称作门(gate)操作。一个Python脚本，我们将其称之为`qpic`，处理这些描述并利用TikZ画图包生成LaTeX代码。

`<q|pic>`的其中之一的设计原则就是保持语言简单。用户可以从中抽出一些量子线路图共有的元素包括单线或者双线，其上面附有文字的矩形门，以及盒状的测量门。这些代码通过LaTeX进行翻译，所以任何数学表达式可以直接传递。目标并不是解决所有人想要的任何问题；相反的，命令被直接传递给LaTeX或者传递给TikZ，所以如果有需要，用户可以补充`<q|pic>`的输出(`qpic`会提供注释足够多的TikZ代码以简化这一过程)。

当然，在这个框架中`<q|pic>`也存在着其实现的局限性。创建TikZ代码的Python代码需要知道这些元素有多大，例如，为了使一个盒子足够大以包含某些文本，用户必须显式地声明宽度。因此可能需要多个循环以将图标正确的排队，而这在利用LaTeX是很正常的。

另一个设计原则为，对其他的可能，`<q|pic>`翻译器首先会从用户的输入创建线路的中间表示，然后从这一表示生成TikZ代码。这个例子就是VERTICAL命令；通过一行，用户可以将图中默认的时间流动方向（从左到右）改变成垂直流（从顶到底）。线路的内部表示在垂直和水平模式上都是相同的。实际上，表示和代码之间的界线并不总是像人们希望的那样清晰。

在这篇文章中，我们会给出一个`<q|pic>`简短但是完整的描述。

## 二、简单的例子

### 2.1 例子一：多数

我们从一个简单到位的多数线路(majority circuit, 获得线路中存在较多的元素)，如[Figure-2](#qpic-2)所示。

<div align=center><img src="{{ site.baseurl }}/assets/images/2021/qpic-2.png" style="zoom:30%" id="qpic-2"></div>

`<q|pic>`代码的前三行使用了`W`指令，这用于声明一条导线。在`W`前面的字符串，是导线的名称，其是必要的并且被用于内部表示。关于导线名称的细则会在后面讨论——简而言之，导线的名称可以是不引起歧义的任何文本，但是由数字和小写字母组成的名称比较安全。这里，导线的名称分别为a, b和c。

如果一个`W`指令后面紧随着一个参数，它会被翻译成一个将会被在数学模式打印的标签并且在被放置在导线的最前面。（如果存在）第二个参数以相同的方式处理，但是它会被放在导线的最后。这里，每条导线都会具有一个开始以及结束标签，表示它的开始值以及结束值。

正常来说，`<q|pic>`语法分析器通过空白符分割每一行。但是，类似于`{a_\oplus_c}`(其中`_`代表一个空白符)这样的表达式就不会被分割。`<q|pic>`的目标语言为$\LaTeX$。所以尖括号(和美元符号)可以用来将一组带有空白符的文本表示为一个实体。

在一个空白行之后(被`<q|pic>`忽略)，第五行包含了我们的第一个门。包含门的这行代码的基本语义是一系列的目标，门(可能还带着一个所需的参数)，接着是一系列的控制(如果存在)。在这种情况中，门的类型为`G`，这意味着在目标周围会画一个矩形。在`G`后所需要的参数是门的名字，这会被放在矩形的中心。因为他会由TikZ处理，所以它可能包含画图命令(在这为`\rotatebox`)。门的名字可能会用美元符号围绕从而使之在数学模式下排版。

除了导线和量子门，`<q|pic>`还允许设置线路图表中其他几种常见元素。第六行的`=`命令接收一个可选参数并将其带着白色背景画在线路的中心。如果就像这个例子一样，没有给任何参数，那么就会画一个等于符号。

剩余的三行包含了额外的门：两个`CNOT`门和一个`Toffoli`门。可以使用`C`表示`CNOT`门而`T`表示`Toffoli`门；例如，第七行本可以写成`b C c`代表一个目标比特为`b`而控制比特为`c`的`CNOT`门。但是，由于这种门十分常见，`<q|pic>`将包含下列符号下面符号的指令当做这样的门：`+`用于说明$\oplus$算符将会作用在这根导线上，任何其他的导线都被当成是控制。注意控制信号可能出现在列表中的任何位置。如果没有列出任何目标，所有的导线都会被当成是控制，从而表明这是一个(受控)Z门。

###2.2 例子二：量子傅里叶变换









